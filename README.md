Проект представляет собой сервис на python

сервис должен запускаться каждые 15 минут по cron 


Используется БД Oracle для работы с бд должен быть создан класс DB соторый создает и поддерживает пул соединений в количестве 5.
И реализует функции запросов.

после запуска сервис должен получить данные последнего выполненного предсказания и его параметры с БД из таблицы table1 отсортированные по полю времени предсказания
а именно:
Время последнего предсказания
Номер сенсора
Номер устройства
Значение смещения по param1
Значение смещения по param2
Результат предсказания

В случае успешного получения значений  table1 сервис должен запросить из table2 данные о измерениях выполненных с момента последнего предсказания. 
Данные измерения должны быть проверены на полноту и валидность и пребразованы в структуру (класс) MeasurementData 
в результате должен получиться список MeasurementData 
Список должен быть отсортирован по времени измерения

затем итеративно проходить по измерениям начиная с самого раннего .
если номер сенсора не изменился относительно последнего предсказания. То к данным обьекта MeasurementData должны быть добавлены param1 и param2 предыдущего измерения. Затем обьект MeasurementData передается в функцию препроцессинга которая возвращает структуру(класс  PreprocessedMeasurement) 
Затем данные PreprocessedMeasurement конвертируются в json для передачи в функцию predict  которая выполняет передает данные модели  и ожидает получения предсказания (до 3 х секунд) затем возвращает результаты предсказания.

В случае если номер сенсора изменился :
 Программа должна убедиться что после замены сенсора получено как миниум по одному измерению от 2 разных устройств произведенных с новым сенсором.
 Если  этого не произошло программа завершает работу не выполняя предсказаний. Для того чтобы выполнить проверку при следующем запуске по cron
 Если в полученных данных присутствет как минимум по одному измерению от 2 разных устройств произведенных с новым сенсором то программа запрашивает по одному последнему измерению произведенных с прошлым сенсором.

 Затем передает  список из 4 измеререний в структуре  MeasurementData каждый в функцию DetectMeasurementShift() которая возвращает параметры param1 и param2

затем после определения новых param1 и param2 они присоединяются к данным MeasurementData которые выполнены после замены сенсора и передаются последовательно в функции препроцессинга и predict

После корректного срабатывания функции predict данные должны быть записаны в table1
